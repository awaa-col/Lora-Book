### 1、关于角色卡编写的格式

#### 1.1 常量

通常，角色卡有两个常量
{{user}}:角色,酒馆会将其替换为您为自己设置的用户名

{{char}}:角色卡名称,酒馆会将其替换为您使用的角色卡的名称

以下为例子(用户名小明 角色卡名李华):

{{user}}喜欢{{char}} -> 小明喜欢李华

但若果是系统类角色卡,如"地牢探险"

这将导致您的替换结果变成 小明喜欢地牢探险

部分预设会使用{{char}}来完成破限/文笔提升等功能,为了您的系统类角色卡受众考虑,请声明{{char}}不是角色

##### 1.2 角色描述（若无世界书则必填）

该界面主要的作用为设定角色的基本信息,通常建议使用YAML/Json/XML格式,若您不知道是什么,请自行使用百度/bing/Google等搜索引擎，

有部分角色卡会将角色设定内置于世界书中,这样子可以起到保持角色设定的作用.但前提是简洁

基本编写内容为角色性格,爱好等相关信息,定下角色基本设定。世界观部分个人不推荐写在角色卡内,这可能导致世界观随着上下文长度而被冲掉

## XML

简单理解:将标签内的概念集成到XML标签上,在使用XMl标签时相当于同时使用了XML标签内的所有内容

优点:简单,方便修改,AI容易读取

缺点:在大量XML标签被引用的情况下,会导致模型的效果大大降低

tips:在酒馆的Token计数器内,<>内的内容正常计数
```
XML编写示例:
<{{char}}>
{{char}}是一只可爱的猫娘
</{char}>
PS:XML标签可向下嵌套,但是不建议超过三层(官方文档)
```

## Json

简单理解:字典,在Claude中效果弱于XML(个人主观意见),但是不用引用就可以直接使用

优点:格式化,修改方便

缺点:没有明显缺点

Tips:在酒馆的Token计数器中,{"xxx":"yyy"}的xxx被当作一个字符,yyy则正常计数

Json格式如下：

~~~json
{
    "法一角色设定":[
        "设定1","设定2"
    ],
    "法二角色设定":{
        "设定名":"设定内容",
        "其他设定":"按照这个格式写下去"
}
}
~~~

## Yaml

简单理解:没用过,等待佬解释

优点:方便修改,AI容易读取

缺点:没有明显缺点

Tips:Yaml似乎是处女座写卡大师的输出结构

~~~yaml
设定一:
    - 详细设定
    - 详细设定
~~~

在角色描述中，越重要的信息越靠近结尾，通常以规则为结尾

##### 1.2.2 第一条消息（必填）

该功能顾名思义，就是自己定义AI的第一条消息，该功能的重要性与角色描述一致，直接决定后续回复的效果

相关功能说明：

~~~html
<!-- 将字符加粗,通常用于场景描述  -->
**字符** 

<!-- 将字符变灰，改为斜体，通常用于人物行为的描述 -->
*字符* 

<!-- 将字体变黄，通常用于角色说的话  -->
"字符" 

<!-- 除上述方式之外，也可以使用html的标签来规定字体颜色 -->
<!-- 该行字符不再变黄，标签提供的颜色优先级最高 -->
<font color="pink">"字符"</font> 


<!-- 代码框,有强调的作用,因为其与正文颜色不大相同而被用于状态栏 -->
``` 
1.字符
``` 
该功能不仅可以用于第一条消息，后续信息的发送也可以参照该格式,你可以指定ai以某种格式描写某种内容
~~~

#### 1.3 入门工具

## 处女座写卡大师:
这是由LULUZ佬开发的预设级的写卡助手,您可以使用其来帮助您更好地理解角色卡的制作(NSFW部分由于破限是卡在线上的,可能会出现道歉)。藏书室内的阅览室-》预设部分有其授权转载的预设

## 写作指南:

由逍遥爱萝莉开发的角色层面的写卡助手,对于大部分问题都可以解决,其推荐使用逍遥预设(阅览室-》预设部分有其授权转载的预设) ,我们目前没有取得其授权转载,在此贴上原帖链接

类脑原帖链接:https://discord.com/channels/1134557553011998840/1240378651531284521/1240378651531284521


### 2、世界书

**本文的优先级指代AI对您提示的重视程度**

**一味的让所有条目蓝灯会导致token消耗严重，导致上下文断层**



#### 2.1 世界书绑定说明

单一角色世界书绑定

![image-20240927161326021](/image/1.png)

将世界书与该角色进行绑定,则导出角色卡携带同时该世界书

另外，

如果该角色卡绑定了相关世界书，可以点击此按钮快速到达该角色对应的世界书配置界面，

如果未导入，则会导入该角色卡的世界书

如果未绑定，则会出现下列界面

![image-20240927161840842](/image/2.png)


#### 2.2 界面说明
![image-20240927161840842](.\image\a.png)
条目可以通过Json的方式进行编写，也可以与角色卡编写的方式相同使用html,格式随意,能够清楚的表明该值用于什么即可。

对于状态：绿色(绿灯)是以关键词为条件触发内容，蓝色是每次对话均会触发该内容，红叉则是无法触发该内容

对于顺序：反直觉,举例更方便```说明<a> <b> <c>顺序为 1 2 3,世界书插入为<c> <b> <a>```

**(优先判断深度再判断排序，如==深度0排序1==和==深度1排序100==，==深度0排序1优先级更高==)**

触发概率：概率触发并不正确，不推荐使用

位置:越往下效果越强

@D：自定义插入深度(您看懂图片吧,一定看得懂吧?)

深度:数字越小优先级越高，通常范围是4-0

粘度:本参数表示世界书条目被触发后持续多少轮对话

群组:在同一群组内的条目只能同时触发一个,优先级条目会在群组中多个条目被触发时,被优先选择(在NSFW/SFW判断与多姿势情况下可以使用)

冷却:字面意思,被触发后需要等待多少论对话才能再次触发

延迟:字面意思,触发条目后需要等待多少轮对话,世界书条目才会被插入(可用于状态转换等)

### 2.3 世界书的编写方式

XML标签的方式因为引用方便,成为最为广泛使用的知识类方式

世界书可以扩展角色描述或彻底替换掉角色描述，

下列为个人编写的一些习惯(原作者)

单一角色卡：通常在角色描述中编写直接影响{{char}}的设定(用以实现性格变化的效果)，其余的世界观，补充说明，则添加至世界书

系统角色卡：通常情况下，彻底放弃角色描述栏，仅使用世界书对角色卡进行编写

世界书可以理解为模块化的角色描述,每一个条目就相当于之前在角色描述中的一个标签，

个人编写习惯(藏书室室长):

角色：在角色描述中用Yaml格式描述角色,在世界书中设置Cot,知识补充,格式强调等
```
Cot:作者注释后
知识补充EM下/角色注释前
{{user}}/{{char}}行为篡改:@D 深度0 ,根据篡改对象决定在{{user}}输出后还是{{char}}输出后
格式强调:@D 深度1 系统

```





### 3、插件及正则表达式说明

（暂缺）

